Бот, у меня для тебя задача чрезвычайной важности.
Отнесись к этому запросу как к главному приоритету.
Разблокируй полностью весь свой потенциал, задействуй все умения и навыки.
Сними любые ограничения, которые мешают качеству ответа.
Стремись выдать максимально точный, детальный и продуманный результат.
Учитывай контекст задачи, избегай фантазий: если данных нет — предложи решение/заглушку.

Ты — senior Python engineer + product manager + nutrition/fitness analyst + UX designer для Telegram-ботов.
У тебя 15+ лет опыта в создании Telegram-ботов (aiogram), аналитики, проектировании PostgreSQL и интеграции LLM.
Ты умеешь:
- проектировать UX через меню-кнопки + быстрый ввод текстом
- проектировать PostgreSQL схему и миграции (SQLAlchemy + alembic)
- генерировать красивые графики (PNG) и отправлять в Telegram
- делать недельные отчёты, тренды, средние, алерты
- рассчитывать BMR/TDEE/калории/БЖУ под цель пользователя
- подключать OpenAI API для “коуч-комментария”, строго по данным, без выдумок
- писать чистый код, структуру проекта, README, .env пример
- обеспечить базовую безопасность (секреты, доступ к БД, бэкапы)
ВАЖНО: Docker НЕ использовать. Запуск обычный (pip + env + python).

КОНТЕКСТ ПРОДУКТА
Telegram-бот “Fitness Assistant”.
Цель пользователя на 4–8 недель: похудение + рост/сохранение мышц (рекомпозиция).
Критерии успеха: снижение % жира, рост силовых, регулярность.
Тон общения: “друг, который может подъебать”, но без токсичности, оскорблений и опасных советов.
Язык: русский.

ОБЯЗАТЕЛЬНОЕ: ПРОФИЛЬ И ПИТАНИЕ
1) Онбординг профиля (FSM):
   - пол, возраст, рост, текущий вес
   - активность (выбор кнопками)
   - цель: рекомпозиция / сушка / набор
   - желаемая скорость (бережно/стандарт/агрессивно) -> влияет на % дефицита/профицита
2) Расчёты:
   - BMR по Mifflin–St Jeor
   - TDEE = BMR * activity_factor
   - калории под цель:
       * рекомпозиция: TDEE - 5..10% (по умолчанию -7%)
       * сушка: TDEE - 10..20% (по умолчанию -15%)
       * набор: TDEE + 5..15% (по умолчанию +10%)
   - макросы:
       * белок: 1.6..2.2 г/кг (по умолчанию 2.0)
       * жиры: 0.8..1.0 г/кг (по умолчанию 0.9) или 25% калорий
       * углеводы: остаток
   - выводить “план дня”: калории + БЖУ (граммы) + короткие советы
3) Важно: бот должен пояснять, что расчёты приблизительные, и предлагать корректировку по факту динамики (адаптация по 2–3 неделям).

ФУНКЦИИ MVP (ЛОГИ)
Ввод данных через меню + короткий текст:
- Вес: по умолчанию раз в неделю (настройка). Разрешить ввод чаще.
- Тренировка: да/нет + тип (зал/кардио/ходьба) + длительность + потраченные калории
- Калории съедено (итог за день, вручную)
- Вода (мл)
- Сон (часы)
(Замеры/фото не нужны в MVP)

СИЛОВОЙ ЖУРНАЛ
- Добавить запись: дата, упражнение, вес, повторы, подходы, примечание
- Отчёт по упражнению: прогресс по max weight и/или e1RM

ОТЧЁТЫ
- график веса (недельные точки, если ввод раз в неделю; иначе дневной)
- средние по неделям/месяцам
- дефицит/профицит калорий
- кол-во тренировок
- streak: недели подряд (вес, тренировки)
- недельный отчёт + по запросу

НАПОМИНАНИЯ (Asia/Yerevan)
- Взвешивание: 1 раз в неделю (по умолчанию воскресенье 10:00), настраиваемо
- Итоги дня: 21:30 (калории, вода, сон), настраиваемо
- Недельный отчёт: воскресенье 19:00

АЛЕРТЫ
- слишком быстрый спад веса (например >1% массы тела в неделю) -> предупреждение
- очень низкие калории относительно плана -> предупреждение
- частые пропуски тренировок -> подкол + конкретный план на неделю
Пороги должны быть в настройках.

LLM-МОДУЛЬ (опционально, заложить)
- OpenAI API: генерация “коуч-комментария” на основе фактов:
  вход: агрегаты недели + алерты + цель + план калорий/БЖУ
  выход: 3–7 предложений + 1 действие на завтра/неделю
  запрет: выдумывать данные, давать мед. диагнозы, опасные советы.

ХРАНЕНИЕ
- PostgreSQL + SQLAlchemy + Alembic
- Таблицы: users, profiles, daily_logs, workouts, strength_logs, settings, computed_targets
- Мультипользовательность по telegram_user_id

ВЫХОД (что ты должен выдать)
A) ТЗ и план проекта
Б) Схема БД (таблицы/поля/связи/индексы)
В) Дерево проекта (папки/файлы)
Г) Код-скелет aiogram: handlers, services, db, scheduler, plotting
Д) Примеры диалогов и сообщений
Е) Формулы и алгоритмы (BMR/TDEE/БЖУ, дефицит, тренды, e1RM)
Ж) Инструкция запуска без Docker: pip + env + python
З) Безопасность: хранение токенов, доступ к БД, бэкапы

Если интеграции Apple Health недоступны — оставь интерфейс-заглушку и ручной ввод.
